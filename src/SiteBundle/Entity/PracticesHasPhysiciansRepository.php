<?php

namespace SiteBundle\Entity;

use Doctrine\ORM\EntityRepository;

/**
 * PracticesHasPhysiciansRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class PracticesHasPhysiciansRepository extends EntityRepository
{

	public function getPracticebyBusinessId($practiceId) {
		$queryBuilder = $this->getEntityManager()->createQueryBuilder("practices_has_physicians", "practices", "practices_locations");
		$queryBuilder->select(
			"practices.practice"
		)
			->from("SiteBundle:PracticesHasPhysicians", "practices_has_physicians")
			->leftJoin("SiteBundle:Practices", "practices")
			->where("practices_has_physicians.practiceId = :practiceId")
			->setParameter("practiceId", $practiceId)
			->leftJoin("SiteBundle:PracticesHasLocations", "practices_locations")
			->where("practices_locations.practice_id = practices.id")
		;

//		$queryBuilder = $this->getEntityManager()->createQueryBuilder("fos_user_bus_xref", "fos_user", "business", "user_details");
//		$queryBuilder->select(
//			"fos_user_bus_xref.id as DT_RowId",
//			"fos_user.username",
//			"user_details.firstName",
//			"user_details.lastName",
//			"user_details.phone"
//		)
//			->from("AdminBundle:FosUserHasBusiness", "fos_user_bus_xref")
//			->innerJoin("fos_user_bus_xref.fosUser", "fos_user")
//			->where("fos_user_bus_xref.fosUser = fos_user.id")
//			->leftJoin("AdminBundle:UserDetails", "user_details", "WITH", "user_details.fosUser = fos_user.id")
//			->innerJoin("fos_user_bus_xref.business", "business")
//			->where("fos_user_bus_xref.business = :businessId")
//			->setParameter("businessId", $businessId)
//		;

		return $queryBuilder->getQuery()->getResult();
	}

}
